<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PocketWatcher - Event Management Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        [x-cloak] { display: none !important; }
        .gradient-bg { background: linear-gradient(180deg, #eadd66 0%, #a24b4b 100%); }
        .card-shadow { box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
        .star-rating { color: #fbbf24; }
        .budget-progress { transition: width 0.3s ease; }
        .modal-backdrop { backdrop-filter: blur(4px); }
    </style>
</head>
<body class="bg-gray-50 min-h-screen" x-data="pocketWatcherApp()" x-init="init()">
    <!-- Navigation -->
    <nav class="bg-white shadow-lg fixed w-full top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <h1 class="text-2xl font-bold text-yellow-800">PocketWatcher</h1>
                </div>
                <div class="flex items-center space-x-4">
                    <template x-if="!isAuthenticated">
                        <div class="space-x-2">
                            <button @click="showLogin = true" class="bg-yellow-600 text-white px-4 py-2 rounded-lg hover:bg-yellow-700">
                                Login
                            </button>
                            <button @click="showRegister = true" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700">
                                Register
                            </button>
                        </div>
                    </template>
                    <template x-if="isAuthenticated">
                        <div class="flex items-center space-x-4">
                            <span class="text-gray-700">Welcome, <span x-text="user.name"></span></span>
                            <button @click="logout()" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700">
                                Logout
                            </button>
                        </div>
                    </template>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="pt-16">
        <!-- Landing Page -->
        <template x-if="!isAuthenticated">
            <div class="gradient-bg text-white py-20">
                <div class="max-w-7xl mx-auto px-4 text-center">
                    <h2 class="text-5xl font-bold mb-6">Connect. Plan. Celebrate.</h2>
                    <p class="text-xl mb-8">The UAE's premier event management platform connecting organizers with trusted vendors</p>
                    <div class="grid md:grid-cols-2 gap-8 mt-12">
                        <div class="bg-white/10 backdrop-blur-md rounded-lg p-6">
                            <i class="fas fa-calendar-alt text-4xl mb-4"></i>
                            <h3 class="text-2xl font-bold mb-2">For Event Organizers</h3>
                            <p>Plan your perfect event with budget management, vendor discovery, and seamless communication</p>
                        </div>
                        <div class="bg-white/10 backdrop-blur-md rounded-lg p-6">
                            <i class="fas fa-store text-4xl mb-4"></i>
                            <h3 class="text-2xl font-bold mb-2">For Vendors</h3>
                            <p>Grow your business by connecting with event organizers across the UAE</p>
                        </div>
                    </div>
                </div>
            </div>
        </template>

        <!-- Dashboard -->
        <template x-if="isAuthenticated">
            <div class="max-w-7xl mx-auto px-4 py-8">
                <!-- Navigation Tabs -->
                <div class="flex space-x-4 mb-8 border-b overflow-x-auto">
                    <button @click="activeTab = 'dashboard'" 
                            :class="activeTab === 'dashboard' ? 'border-yellow-500 text-yellow-600' : 'border-transparent text-gray-500'"
                            class="border-b-2 px-4 py-2 font-medium whitespace-nowrap">
                        Dashboard
                    </button>
                    <button @click="activeTab = 'events'" 
                            :class="activeTab === 'events' ? 'border-yellow-500 text-yellow-600' : 'border-transparent text-gray-500'"
                            class="border-b-2 px-4 py-2 font-medium whitespace-nowrap">
                        My Events
                    </button>
                    <button @click="activeTab = 'vendors'" 
                            :class="activeTab === 'vendors' ? 'border-yellow-500 text-yellow-600' : 'border-transparent text-gray-500'"
                            class="border-b-2 px-4 py-2 font-medium whitespace-nowrap">
                        Find Vendors
                    </button>
                    <button @click="activeTab = 'messages'" 
                            :class="activeTab === 'messages' ? 'border-yellow-500 text-yellow-600' : 'border-transparent text-gray-500'"
                            class="border-b-2 px-4 py-2 font-medium whitespace-nowrap">
                        Messages
                    </button>
                </div>

                <!-- Dashboard Tab -->
                <div x-show="activeTab === 'dashboard'" x-cloak>
                    <h2 class="text-3xl font-bold mb-6">Dashboard</h2>
                    <div class="grid md:grid-cols-3 gap-6 mb-8">
                        <div class="bg-white rounded-lg card-shadow p-6">
                            <div class="text-2xl font-bold text-yellow-600">5</div>
                            <div class="text-gray-600">Active Events</div>
                        </div>
                        <div class="bg-white rounded-lg card-shadow p-6">
                            <div class="text-2xl font-bold text-green-600">12</div>
                            <div class="text-gray-600">Vendor Connections</div>
                        </div>
                        <div class="bg-white rounded-lg card-shadow p-6">
                            <div class="text-2xl font-bold text-blue-600">AED 45,000</div>
                            <div class="text-gray-600">Total Budget</div>
                        </div>
                    </div>
                </div>

                <!-- Events Tab -->
                <div x-show="activeTab === 'events'" x-cloak>
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-3xl font-bold">My Events</h2>
                        <button @click="createSampleEvent()" class="bg-yellow-600 text-white px-4 py-2 rounded-lg hover:bg-yellow-700">
                            <i class="fas fa-plus mr-2"></i>Create Sample Event
                        </button>
                    </div>

                    <div class="grid gap-6">
                        <template x-for="event in events" :key="event._id">
                            <div class="bg-white rounded-lg card-shadow p-6">
                                <h3 class="text-xl font-bold mb-2" x-text="event.title"></h3>
                                <p class="text-gray-600 mb-4" x-text="event.description"></p>
                                <div class="flex items-center space-x-4 text-sm text-gray-500">
                                    <span><i class="fas fa-calendar mr-1"></i><span x-text="event.date"></span></span>
                                    <span><i class="fas fa-users mr-1"></i><span x-text="event.attendees"></span> guests</span>
                                    <span><i class="fas fa-dollar-sign mr-1"></i>AED <span x-text="event.budget?.toLocaleString()"></span></span>
                                </div>
                            </div>
                        </template>
                        <template x-if="events.length === 0">
                            <div class="text-center text-gray-500 py-12">
                                <i class="fas fa-calendar-plus text-6xl mb-4"></i>
                                <h3 class="text-xl font-medium mb-2">No events yet</h3>
                                <p class="mb-4">Create your first event to get started</p>
                                <button @click="createSampleEvent()" class="bg-yellow-600 text-white px-6 py-3 rounded-lg hover:bg-yellow-700">
                                    Create Sample Event
                                </button>
                            </div>
                        </template>
                    </div>
                </div>

                <!-- Vendors Tab -->
                <div x-show="activeTab === 'vendors'" x-cloak>
                    <h2 class="text-3xl font-bold mb-6">Find Vendors</h2>
                    
                    <div class="mb-6">
                        <button @click="loadSampleVendors()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 mb-4">
                            Load Sample Vendors
                        </button>
                    </div>

                    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <template x-for="vendor in vendors" :key="vendor._id">
                            <div class="bg-white rounded-lg card-shadow p-6">
                                <h3 class="text-lg font-bold mb-2" x-text="vendor.businessName"></h3>
                                <p class="text-gray-600 mb-3" x-text="vendor.category"></p>
                                <div class="flex items-center mb-3">
                                    <div class="flex star-rating">
                                        <template x-for="i in 5" :key="i">
                                            <i :class="i <= vendor.rating ? 'fas fa-star' : 'far fa-star'"></i>
                                        </template>
                                    </div>
                                    <span class="text-sm text-gray-500 ml-2">(<span x-text="vendor.reviews"></span> reviews)</span>
                                </div>
                                <button @click="contactVendor(vendor)" class="w-full bg-yellow-600 text-white px-4 py-2 rounded hover:bg-yellow-700">
                                    <i class="fas fa-message mr-2"></i>Contact Vendor
                                </button>
                            </div>
                        </template>
                    </div>
                </div>

                <!-- Messages Tab -->
                <div x-show="activeTab === 'messages'" x-cloak>
                    <h2 class="text-3xl font-bold mb-6">Messages</h2>
                    
                    <!-- Debug Info -->
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6" x-show="debugMode">
                        <h3 class="font-bold text-blue-800 mb-2">Debug Info:</h3>
                        <div class="text-sm text-blue-700">
                            <p>Conversations count: <span x-text="conversations.length"></span></p>
                            <p>Selected conversation: <span x-text="selectedConversation ? selectedConversation.participant.businessName : 'None'"></span></p>
                            <p>Current messages count: <span x-text="currentMessages.length"></span></p>
                            <p>Loading state: <span x-text="messagesLoading ? 'Loading...' : 'Ready'"></span></p>
                        </div>
                        <button @click="debugMode = false" class="mt-2 text-blue-600 hover:text-blue-800">Hide Debug</button>
                    </div>
                    
                    <div class="grid md:grid-cols-3 gap-6">
                        <!-- Conversations List -->
                        <div class="bg-white rounded-lg card-shadow p-4">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="font-bold">Conversations</h3>
                                <button @click="debugMode = !debugMode" class="text-gray-500 hover:text-gray-700">
                                    <i class="fas fa-bug"></i>
                                </button>
                            </div>
                            
                            <div class="space-y-2">
                                <template x-for="conversation in conversations" :key="conversation._id">
                                    <div @click="selectConversation(conversation)" 
                                         :class="selectedConversation?._id === conversation._id ? 'bg-yellow-50 border-yellow-200' : 'bg-gray-50'"
                                         class="p-3 rounded-lg cursor-pointer border hover:bg-gray-100 transition-colors">
                                        <div class="flex items-center space-x-3">
                                            <div class="w-10 h-10 bg-yellow-600 rounded-full flex items-center justify-center text-white font-bold">
                                                <span x-text="conversation.participant.businessName.charAt(0)"></span>
                                            </div>
                                            <div class="flex-1 min-w-0">
                                                <p class="font-medium truncate" x-text="conversation.participant.businessName"></p>
                                                <p class="text-sm text-gray-500 truncate" x-text="conversation.lastMessage || 'No messages yet'"></p>
                                            </div>
                                            <template x-if="conversation.unreadCount > 0">
                                                <span class="bg-red-500 text-white text-xs rounded-full px-2 py-1" x-text="conversation.unreadCount"></span>
                                            </template>
                                        </div>
                                    </div>
                                </template>
                                
                                <template x-if="conversations.length === 0">
                                    <div class="text-center text-gray-500 py-8">
                                        <i class="fas fa-comments text-4xl mb-4"></i>
                                        <p>No conversations yet</p>
                                        <button @click="loadSampleConversations()" class="mt-2 text-blue-600 hover:text-blue-800">
                                            Load Sample Conversations
                                        </button>
                                    </div>
                                </template>
                            </div>
                        </div>

                        <!-- Chat Area -->
                        <div class="md:col-span-2 bg-white rounded-lg card-shadow flex flex-col h-96">
                            <template x-if="selectedConversation">
                                <div class="flex flex-col h-full">
                                    <!-- Chat Header -->
                                    <div class="p-4 border-b">
                                        <div class="flex items-center justify-between">
                                            <div>
                                                <h3 class="font-bold" x-text="selectedConversation.participant.businessName"></h3>
                                                <p class="text-sm text-gray-500" x-text="selectedConversation.participant.category"></p>
                                            </div>
                                            <div class="text-xs text-gray-400" x-show="messagesLoading">
                                                Loading messages...
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Messages -->
                                    <div class="flex-1 p-4 overflow-y-auto space-y-3" id="messagesContainer">
                                        <template x-if="messagesLoading">
                                            <div class="text-center text-gray-500 py-8">
                                                <i class="fas fa-spinner fa-spin text-2xl mb-2"></i>
                                                <p>Loading messages...</p>
                                            </div>
                                        </template>
                                        
                                        <template x-if="!messagesLoading && currentMessages.length === 0">
                                            <div class="text-center text-gray-500 py-8">
                                                <i class="fas fa-comment text-4xl mb-4"></i>
                                                <p>No messages yet. Start the conversation!</p>
                                            </div>
                                        </template>
                                        
                                        <template x-for="message in currentMessages" :key="message._id">
                                            <div :class="message.sender._id === user.id ? 'ml-auto' : 'mr-auto'"
                                                 class="max-w-xs">
                                                <div :class="message.sender._id === user.id ? 'bg-yellow-600 text-white' : 'bg-gray-200 text-gray-800'"
                                                     class="px-4 py-2 rounded-lg">
                                                    <p x-text="message.content"></p>
                                                    <p class="text-xs opacity-75 mt-1" x-text="formatMessageTime(message.createdAt)"></p>
                                                </div>
                                            </div>
                                        </template>
                                    </div>

                                    <!-- Message Input -->
                                    <div class="p-4 border-t">
                                        <div class="flex space-x-2">
                                            <input x-model="newMessage" @keyup.enter="sendMessage()" 
                                                   type="text" placeholder="Type a message..." 
                                                   :disabled="messagesLoading"
                                                   class="flex-1 border rounded-lg px-3 py-2 disabled:bg-gray-100">
                                            <button @click="sendMessage()" 
                                                    :disabled="!newMessage.trim() || messagesLoading"
                                                    class="bg-yellow-600 text-white px-4 py-2 rounded-lg hover:bg-yellow-700 disabled:bg-gray-400">
                                                <i class="fas fa-paper-plane"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </template>
                            
                            <template x-if="!selectedConversation">
                                <div class="flex items-center justify-center h-full text-gray-500">
                                    <div class="text-center">
                                        <i class="fas fa-comments text-4xl mb-4"></i>
                                        <p>Select a conversation to start messaging</p>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </div>
                </div>
            </div>
        </template>
    </div>

    <!-- Modals -->
    
    <!-- Login Modal -->
    <div x-show="showLogin" x-cloak class="fixed inset-0 bg-black bg-opacity-50 modal-backdrop flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-8 max-w-md w-full mx-4" @click.away="showLogin = false">
            <h2 class="text-2xl font-bold mb-6">Login</h2>
            <form @submit.prevent="login()">
                <div class="mb-4">
                    <label class="block text-sm font-medium mb-2">Email</label>
                    <input x-model="loginForm.email" type="email" required class="w-full border rounded-lg px-3 py-2">
                </div>
                <div class="mb-6">
                    <label class="block text-sm font-medium mb-2">Password</label>
                    <input x-model="loginForm.password" type="password" required class="w-full border rounded-lg px-3 py-2">
                </div>
                <div class="flex justify-between">
                    <button type="button" @click="showLogin = false" class="bg-gray-300 text-gray-700 px-4 py-2 rounded-lg">
                        Cancel
                    </button>
                    <button type="submit" class="bg-yellow-600 text-white px-4 py-2 rounded-lg hover:bg-yellow-700">
                        Login
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Register Modal -->
    <div x-show="showRegister" x-cloak class="fixed inset-0 bg-black bg-opacity-50 modal-backdrop flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-8 max-w-md w-full mx-4" @click.away="showRegister = false">
            <h2 class="text-2xl font-bold mb-6">Register</h2>
            <form @submit.prevent="register()">
                <div class="mb-4">
                    <label class="block text-sm font-medium mb-2">Name</label>
                    <input x-model="registerForm.name" type="text" required class="w-full border rounded-lg px-3 py-2">
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium mb-2">Email</label>
                    <input x-model="registerForm.email" type="email" required class="w-full border rounded-lg px-3 py-2">
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium mb-2">Password</label>
                    <input x-model="registerForm.password" type="password" required class="w-full border rounded-lg px-3 py-2">
                </div>
                <div class="mb-6">
                    <label class="block text-sm font-medium mb-2">User Type</label>
                    <select x-model="registerForm.userType" required class="w-full border rounded-lg px-3 py-2">
                        <option value="">Select Type</option>
                        <option value="organizer">Event Organizer</option>
                        <option value="vendor">Service Vendor</option>
                    </select>
                </div>
                <div class="flex justify-between">
                    <button type="button" @click="showRegister = false" class="bg-gray-300 text-gray-700 px-4 py-2 rounded-lg">
                        Cancel
                    </button>
                    <button type="submit" class="bg-yellow-600 text-white px-4 py-2 rounded-lg hover:bg-yellow-700">
                        Register
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div x-show="toast.show" x-cloak 
         x-transition:enter="transition ease-out duration-300"
         x-transition:enter-start="opacity-0 transform translate-y-2"
         x-transition:enter-end="opacity-100 transform translate-y-0"
         x-transition:leave="transition ease-in duration-200"
         x-transition:leave-start="opacity-100 transform translate-y-0"
         x-transition:leave-end="opacity-0 transform translate-y-2"
         class="fixed top-20 right-4 z-50">
        <div :class="toast.type === 'success' ? 'bg-green-500' : 'bg-red-500'" 
             class="text-white px-6 py-3 rounded-lg shadow-lg">
            <p x-text="toast.message"></p>
        </div>
    </div>

    <script>
        function pocketWatcherApp() {
            return {
                // State
                isAuthenticated: false,
                user: { id: 'user123', name: 'Demo User' },
                loading: false,
                activeTab: 'dashboard',
                debugMode: false,
                messagesLoading: false,
                
                // Modal states
                showLogin: false,
                showRegister: false,
                
                // Selected items
                selectedConversation: null,
                
                // Forms
                loginForm: { email: '', password: '' },
                registerForm: { name: '', email: '', password: '', userType: '' },
                
                // Data
                events: [],
                vendors: [],
                conversations: [],
                currentMessages: [],
                newMessage: '',
                
                // Toast
                toast: { show: false, message: '', type: 'success' },
                
                // Initialize
                init() {
                    // For demo purposes, auto-login
                    this.autoLogin();
                },
                
                autoLogin() {
                    this.isAuthenticated = true;
                    this.user = {
                        id: 'user123',
                        name: 'Demo User',
                        userType: 'organizer'
                    };
                },
                
                // Authentication
                login() {
                    this.isAuthenticated = true;
                    this.user = {
                        id: 'user123',
                        name: this.loginForm.email.split('@')[0],
                        userType: 'organizer'
                    };
                    this.showLogin = false;
                    this.showToast('Login successful!', 'success');
                },
                
                register() {
                    this.isAuthenticated = true;
                    this.user = {
                        id: 'user123',
                        name: this.registerForm.name,
                        userType: this.registerForm.userType
                    };
                    this.showRegister = false;
                    this.showToast('Registration successful!', 'success');
                },
                
                logout() {
                    this.isAuthenticated = false;
                    this.user = {};
                    this.activeTab = 'dashboard';
                    this.showToast('Logged out successfully', 'success');
                },
                
                // Sample Data Functions
                createSampleEvent() {
                    const newEvent = {
                        _id: 'event' + Date.now(),
                        title: 'Corporate Retreat 2024',
                        description: 'Annual company retreat with team building activities',
                        date: '2024-06-15',
                        attendees: 50,
                        budget: 25000,
                        status: 'planning'
                    };
                    this.events.unshift(newEvent);
                    this.showToast('Sample event created!', 'success');
                },
                
                loadSampleVendors() {
                    this.vendors = [
                        {
                            _id: 'vendor1',
                            businessName: 'Elite Catering Dubai',
                            category: 'Catering',
                            rating: 4.8,
                            reviews: 127,
                            contact: { phone: '+971 50 123 4567' }
                        },
                        {
                            _id: 'vendor2',
                            businessName: 'Pixel Perfect Photography',
                            category: 'Photography',
                            rating: 4.9,
                            reviews: 89,
                            contact: { phone: '+971 55 987 6543' }
                        },
                        {
                            _id: 'vendor3',
                            businessName: 'Sound & Vision AV',
                            category: 'Audio Visual',
                            rating: 4.7,
                            reviews: 156,
                            contact: { phone: '+971 52 456 7890' }
                        }
                    ];
                    this.showToast('Sample vendors loaded!', 'success');
                },
                
                loadSampleConversations() {
                    this.conversations = [
                        {
                            _id: 'conv1',
                            participant: {
                                _id: 'vendor1',
                                businessName: 'Elite Catering Dubai',
                                category: 'Catering'
                            },
                            lastMessage: 'Thank you for your interest in our catering services!',
                            unreadCount: 2
                        },
                        {
                            _id: 'conv2',
                            participant: {
                                _id: 'vendor2',
                                businessName: 'Pixel Perfect Photography',
                                category: 'Photography'
                            },
                            lastMessage: 'I can definitely help with your event photography',
                            unreadCount: 0
                        },
                        {
                            _id: 'conv3',
                            participant: {
                                _id: 'vendor3',
                                businessName: 'Sound & Vision AV',
                                category: 'Audio Visual'
                            },
                            lastMessage: 'Our AV packages start from AED 2,500',
                            unreadCount: 1
                        }
                    ];
                    this.showToast('Sample conversations loaded!', 'success');
                },
                
                // Contact vendor from vendor list
                contactVendor(vendor) {
                    // Check if conversation already exists
                    let conversation = this.conversations.find(c => 
                        c.participant._id === vendor._id
                    );
                    
                    if (!conversation) {
                        // Create new conversation
                        conversation = {
                            _id: 'conv' + Date.now(),
                            participant: {
                                _id: vendor._id,
                                businessName: vendor.businessName,
                                category: vendor.category
                            },
                            lastMessage: '',
                            unreadCount: 0
                        };
                        this.conversations.unshift(conversation);
                    }
                    
                    // Switch to messages tab and select conversation
                    this.activeTab = 'messages';
                    this.selectConversation(conversation);
                    this.showToast(`Started conversation with ${vendor.businessName}`, 'success');
                },
                
                // Messaging
                selectConversation(conversation) {
                    this.selectedConversation = conversation;
                    this.loadMessages(conversation.participant._id);
                    
                    // Mark as read
                    conversation.unreadCount = 0;
                },
                
                loadMessages(recipientId) {
                    this.messagesLoading = true;
                    
                    // Simulate API delay
                    setTimeout(() => {
                        // Load sample messages based on vendor
                        const sampleMessages = this.getSampleMessages(recipientId);
                        this.currentMessages = sampleMessages;
                        this.messagesLoading = false;
                        
                        // Scroll to bottom
                        this.$nextTick(() => {
                            const container = document.getElementById('messagesContainer');
                            if (container) {
                                container.scrollTop = container.scrollHeight;
                            }
                        });
                    }, 500);
                },
                
                getSampleMessages(vendorId) {
                    const messageSets = {
                        'vendor1': [
                            {
                                _id: 'msg1',
                                content: 'Hello! I\'m interested in your catering services for our corporate event.',
                                sender: { _id: this.user.id },
                                createdAt: new Date(Date.now() - 3600000).toISOString()
                            },
                            {
                                _id: 'msg2',
                                content: 'Thank you for your interest! We specialize in corporate catering. How many guests are you expecting?',
                                sender: { _id: vendorId },
                                createdAt: new Date(Date.now() - 3000000).toISOString()
                            },
                            {
                                _id: 'msg3',
                                content: 'We\'re expecting around 50 guests for a half-day retreat.',
                                sender: { _id: this.user.id },
                                createdAt: new Date(Date.now() - 2400000).toISOString()
                            },
                            {
                                _id: 'msg4',
                                content: 'Perfect! For 50 guests, we offer several packages starting from AED 75 per person. Would you like me to send you our detailed menu options?',
                                sender: { _id: vendorId },
                                createdAt: new Date(Date.now() - 1800000).toISOString()
                            }
                        ],
                        'vendor2': [
                            {
                                _id: 'msg5',
                                content: 'Hi! Looking for event photography services.',
                                sender: { _id: this.user.id },
                                createdAt: new Date(Date.now() - 7200000).toISOString()
                            },
                            {
                                _id: 'msg6',
                                content: 'Hello! I\'d be happy to help with your event photography. What type of event are you planning?',
                                sender: { _id: vendorId },
                                createdAt: new Date(Date.now() - 6600000).toISOString()
                            },
                            {
                                _id: 'msg7',
                                content: 'It\'s a corporate retreat with team building activities.',
                                sender: { _id: this.user.id },
                                createdAt: new Date(Date.now() - 6000000).toISOString()
                            }
                        ],
                        'vendor3': [
                            {
                                _id: 'msg8',
                                content: 'Need audio visual equipment for our event.',
                                sender: { _id: this.user.id },
                                createdAt: new Date(Date.now() - 5400000).toISOString()
                            },
                            {
                                _id: 'msg9',
                                content: 'Great! We have comprehensive AV packages. Our basic setup includes microphones, speakers, and projection. What\'s your venue like?',
                                sender: { _id: vendorId },
                                createdAt: new Date(Date.now() - 4800000).toISOString()
                            }
                        ]
                    };
                    
                    return messageSets[vendorId] || [];
                },
                
                sendMessage() {
                    if (!this.newMessage.trim() || !this.selectedConversation) return;
                    
                    const newMessage = {
                        _id: 'msg' + Date.now(),
                        content: this.newMessage,
                        sender: { _id: this.user.id },
                        createdAt: new Date().toISOString()
                    };
                    
                    this.currentMessages.push(newMessage);
                    
                    // Update conversation last message
                    this.selectedConversation.lastMessage = this.newMessage;
                    
                    this.newMessage = '';
                    
                    // Scroll to bottom
                    this.$nextTick(() => {
                        const container = document.getElementById('messagesContainer');
                        if (container) {
                            container.scrollTop = container.scrollHeight;
                        }
                    });
                    
                    // Simulate vendor response after 2 seconds
                    setTimeout(() => {
                        this.simulateVendorResponse();
                    }, 2000);
                },
                
                simulateVendorResponse() {
                    if (!this.selectedConversation) return;
                    
                    const responses = [
                        "Thank you for your message! I'll get back to you with more details shortly.",
                        "That sounds great! Let me prepare a custom quote for you.",
                        "I'd be happy to help with that. When is your event date?",
                        "Perfect! I have availability for that date. Let me send you our package details.",
                        "Excellent! I'll prepare a proposal and send it over within 24 hours."
                    ];
                    
                    const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                    
                    const vendorMessage = {
                        _id: 'msg' + Date.now(),
                        content: randomResponse,
                        sender: { _id: this.selectedConversation.participant._id },
                        createdAt: new Date().toISOString()
                    };
                    
                    this.currentMessages.push(vendorMessage);
                    this.selectedConversation.lastMessage = randomResponse;
                    
                    // Scroll to bottom
                    this.$nextTick(() => {
                        const container = document.getElementById('messagesContainer');
                        if (container) {
                            container.scrollTop = container.scrollHeight;
                        }
                    });
                },
                
                // Utility Functions
                formatMessageTime(dateString) {
                    const date = new Date(dateString);
                    const now = new Date();
                    const diffInHours = (now - date) / (1000 * 60 * 60);
                    
                    if (diffInHours < 1) {
                        return 'Just now';
                    } else if (diffInHours < 24) {
                        return Math.floor(diffInHours) + 'h ago';
                    } else {
                        return date.toLocaleDateString();
                    }
                },
                
                showToast(message, type = 'success') {
                    this.toast = { show: true, message, type };
                    setTimeout(() => {
                        this.toast.show = false;
                    }, 3000);
                }
            }
        }
    </script>
</body>
</html>
